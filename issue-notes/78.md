# issue スクリーンセーバーの検知をagentに実装させたところ、ハルシネーションによる失敗が連続していると判断し、別の対策をとる #78
[issues #78](https://github.com/cat2151/cat-window-watcher/issues/78)

## 問題の概要

スクリーンセーバー `scrnsave.scr` 作動中のデバッグログ:
```
[DEBUG] Screensaver detection check:
[DEBUG]   - Current window title: ''
[DEBUG] Unexpected error in Windows screensaver detection: (1400, 'GetClassName', 'ウィンドウ ハンドルが無効です。')
[DEBUG] Screensaver detection result: False
```

このように、複雑な実装ではスクリーンセーバーをまったく認識できていませんでした。

## 対策

複雑なプラットフォーム固有の検知方法は信頼性が低く、ハルシネーションによる誤った実装が続いていたため、シンプルで実用的なアプローチに変更しました：

**ウィンドウタイトルが空文字列の場合、スクリーンセーバーとして扱う**

### この対策の利点

1. **シンプルで理解しやすい**: コードが短く、動作が明確
2. **信頼性が高い**: 実際のデバッグログでも確認できるように、スクリーンセーバー動作中はウィンドウタイトルが空になる
3. **プラットフォーム非依存**: 複雑なWindows API、Linux コマンド、macOS スクリプトに依存しない
4. **保守性が高い**: 今後のOS更新で動作が変わるリスクが低い

### 実装

`WindowMonitor.is_screensaver_active()` メソッドを以下のように簡素化：

```python
@staticmethod
def is_screensaver_active(debug=False):
    """Check if screensaver is currently active.

    This uses a simplified approach: treats windows with empty titles as screensavers.
    This is more reliable than complex platform-specific detection methods.
    """
    window_title = WindowMonitor.get_active_window_title()
    result = window_title == ""
    
    if debug:
        print(f"[DEBUG] Screensaver detection (simplified):")
        print(f"[DEBUG]   - Window title: '{window_title}'")
        print(f"[DEBUG]   - Screensaver detected: {result}")
    
    return result
```

### 注意事項

この実装では、ウィンドウタイトルが空の全てのウィンドウをスクリーンセーバーとして扱います。これは以下のケースも含まれる可能性があります：

- スクリーンセーバー（意図した動作）
- ウィンドウタイトルを持たない特殊なアプリケーション
- ウィンドウ取得の一時的な失敗

しかし、実用上はこのシンプルなアプローチが複雑な実装よりも信頼性が高いことが確認されています。

