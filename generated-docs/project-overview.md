Last updated: 2025-11-10

# Project Overview

## プロジェクト概要
- アクティブなウィンドウを監視し、生産性に応じてスコアを調整するシンプルなツールです。
- 定義されたパターン（例: GitHubでの作業）に基づいてスコアが増減し、現在の活動を可視化します。
- tkinterによる直感的なGUIでスコアと活動状況を表示し、ユーザーの集中をサポートします。

## 技術スタック
- フロントエンド: **tkinter**: Pythonの標準GUIライブラリで、軽量かつシンプルなユーザーインターフェースを構築するために使用されています。
- 音楽・オーディオ: 該当なし
- 開発ツール:
    - **Git**: ソースコードのバージョン管理システムとして使用されています。
    - **ruff**: Pythonコードの高速なリンティングとフォーマットをEcosystemで統一されたルールで提供し、コード品質と可読性を維持します。
- テスト:
    - **unittest**: Python標準の単体テストフレームワークで、各モジュールの機能が期待通りに動作するかを検証するために使用されています。
    - **pytest**: 高度なテストフレームワークであり、unittestと連携してテストの実行や管理を柔軟に行うために利用されています。
- ビルドツール: 該当なし（主にPythonスクリプトとして直接実行されます）
- 言語機能:
    - **Python 3.12+**: プロジェクトの主要なプログラミング言語であり、最新の言語機能とパフォーマンスを利用しています。
    - **正規表現 (regex)**: ウィンドウタイトルを柔軟にパターンマッチングするために使用され、ユーザーがカスタマイズ可能なルール設定を可能にしています。
- 自動化・CI/CD:
    - **pre-commit**: Gitコミット前に自動でコード整形やリンティングを実行し、コード品質の標準化と維持を助けます。
- 開発標準:
    - **.editorconfig**: 異なるエディタやIDE間で一貫したコーディングスタイル（インデント、改行など）を強制するために使用されます。
    - **ruff**: コードスタイルの一貫性を保ち、PythonのPEP 8などの標準に従うための設定がされています。
- 設定管理:
    - **TOML**: 設定ファイル（`config.toml`）の記述形式として採用されており、人間が読みやすく、構造化された設定を簡単に管理できます。
- OS連携:
    - **xdotool / xprop (Linux)**: Linux環境でアクティブなウィンドウの情報を取得するために使用されるコマンドラインツールです。
    - **AppleScript (macOS)**: macOS環境でアクティブなウィンドウのタイトルを取得するために使用されるスクリプト言語です。
    - **pywin32 (Windows)**: Windows APIへのPythonインターフェースを提供し、より安定したウィンドウ監視機能を実現するためにオプションで推奨されます。

## ファイル階層ツリー
```
📄 .editorconfig
📄 .gitignore
📄 .pre-commit-config.yaml
📁 .vscode/
  📊 settings.json
📄 LICENSE
📖 README.md
📖 USAGE.md
📄 _config.yml
📄 config.toml.example
📁 examples/
  📄 example.txt
📁 generated-docs/
📄 pytest.ini
📄 ruff.toml
📁 src/
  📄 __init__.py
  📄 __main__.py
  📄 config.py
  📄 gui.py
  📄 main.py
  📄 score_tracker.py
  📄 window_monitor.py
📁 tests/
  📄 test_config.py
  📄 test_dummy.py
  📄 test_score_tracker.py
  📄 test_window_monitor.py
```

## ファイル詳細説明
- **.editorconfig**: 各種エディタでコードスタイル（インデント、改行コードなど）を統一するための設定ファイルです。
- **.gitignore**: Gitのバージョン管理から除外するファイルやディレクトリを指定します。
- **.pre-commit-config.yaml**: Gitコミット前に自動でコード整形やリンティングなどのフックを実行するための設定ファイルです。
- **.vscode/settings.json**: VS Codeエディタのワークスペース固有の設定を定義し、開発環境の一貫性を保ちます。
- **LICENSE**: プロジェクトのライセンス情報が記載されています。
- **README.md**: プロジェクトの概要、インストール方法、設定、使用方法、開発情報など、プロジェクトに関する主要な情報を提供します。
- **USAGE.md**: プロジェクトの使用方法に特化した詳細なドキュメントです。
- **_config.yml**: GitHub Pagesなどの静的サイトジェネレータで使用される可能性のある設定ファイルです。
- **config.toml.example**: ユーザーがコピーしてカスタマイズするための設定ファイル（TOML形式）のサンプルです。
- **examples/example.txt**: プロジェクトの機能や使用方法を示すための例のファイルです。
- **generated-docs/**: プロジェクトから自動生成されるドキュメントを格納するためのディレクトリです。
- **pytest.ini**: pytestテストフレームワークの設定ファイルです。
- **ruff.toml**: ruffリンタ・フォーマッタのルールや設定を定義するファイルです。
- **src/__init__.py**: `src`ディレクトリがPythonパッケージであることを示す空のファイルです。
- **src/__main__.py**: `python -m src`のようにモジュールとして実行された際に、`main.py`を呼び出すエントリーポイントとして機能します。
- **src/config.py**: TOML形式の設定ファイルをロードし、アプリケーション全体で利用可能な設定データとして管理するモジュールです。
- **src/gui.py**: Pythonのtkinterライブラリを使用して、現在のスコアと活動状況を表示するユーザーインターフェースを定義するモジュールです。
- **src/main.py**: アプリケーションの主要なエントリーポイントです。設定のロード、ウィンドウ監視の開始、スコアの追跡、GUIの更新など、主要なコンポーネントを統合し、アプリケーションの実行を orchestrate します。
- **src/score_tracker.py**: アクティブなウィンドウのタイトルを設定済みの正規表現パターンと照合し、それに基づいてスコアを計算・追跡するロジックを実装したモジュールです。
- **src/window_monitor.py**: Linux、macOS、Windowsといった異なるオペレーティングシステムに対応し、現在アクティブなウィンドウのタイトルをクロスプラットフォームで取得する機能を提供するモジュールです。
- **tests/test_config.py**: `src/config.py`モジュールの機能（設定のロード、パースなど）が正しく動作するかを検証するための単体テストファイルです。
- **tests/test_dummy.py**: テストの基本的な構造や動作を示すためのダミーまたは例のテストファイルです。
- **tests/test_score_tracker.py**: `src/score_tracker.py`モジュールの機能（スコア計算、パターンマッチングなど）が正しく動作するかを検証するための単体テストファイルです。
- **tests/test_window_monitor.py**: `src/window_monitor.py`モジュールの機能（アクティブウィンドウタイトルの取得など）が正しく動作するかを検証するための単体テストファイルです。

## 関数詳細説明
- **`run_app(config_path=None)`** (src/main.py):
    - **役割**: アプリケーションのメインループを開始し、全ての主要コンポーネント（設定、ウィンドウ監視、スコア追跡、GUI）を統合・実行します。
    - **引数**:
        - `config_path` (str, オプション): カスタム設定ファイルへのパス。指定されない場合はデフォルトの設定ファイルが使用されます。
    - **戻り値**: None
    - **機能**: 設定をロードし、`WindowMonitor`、`ScoreTracker`、`GUI`インスタンスを初期化します。その後、定期的にアクティブなウィンドウを監視し、スコアを更新し、GUIにその情報を表示し続けます。
- **`load_config(config_path)`** (src/config.py):
    - **役割**: 指定されたパスからTOML形式の設定ファイルをロードし、アプリケーションで利用可能な形式で提供します。
    - **引数**:
        - `config_path` (str): 設定ファイルへのパス。
    - **戻り値**: dict: ロードされ、パースされた設定データを含む辞書。
    - **機能**: 指定されたパスのTOMLファイルを読み込み、その内容をPythonの辞書オブジェクトに変換します。設定ファイルの存在チェックやエラーハンドリングも行います。
- **`get_active_window_title()`** (src/window_monitor.py):
    - **役割**: 現在システム上でアクティブになっているウィンドウのタイトルを取得します。
    - **引数**: なし
    - **戻り値**: str: アクティブなウィンドウのタイトル文字列。タイトルが取得できない場合やエラーの場合は空文字列を返すことがあります。
    - **機能**: 実行されているオペレーティングシステム（Linux, macOS, Windows）に応じて適切なOS固有のAPIや外部コマンド（例: `xdotool`、AppleScript、Windows API）を利用して、最前面のウィンドウのタイトルをプログラム的に取得します。
- **`update_score(window_title)`** (src/score_tracker.py):
    - **役割**: 指定されたウィンドウタイトルに基づいて現在のスコアを更新します。
    - **引数**:
        - `window_title` (str): 現在アクティブなウィンドウのタイトル。
    - **戻り値**: tuple (int, str): 更新後の現在の合計スコアと、マッチした（または最も優先度の高い）パターンの説明文字列。
    - **機能**: `load_config`でロードされた設定内の正規表現パターンと`window_title`を照合します。一致するパターンが見つかった場合、関連するスコア値を現在の合計スコアに加算し、マッチしたパターンの説明を返します。
- **`get_current_score()`** (src/score_tracker.py):
    - **役割**: 現在の合計スコアを取得します。
    - **引数**: なし
    - **戻り値**: int: 現在の合計スコア。
    - **機能**: 内部で管理されている現在の合計スコア値を返します。
- **`update_display(score, description)`** (src/gui.py):
    - **役割**: GUI上のスコアとステータス表示を更新します。
    - **引数**:
        - `score` (int): GUIに表示する新しいスコア値。
        - `description` (str): 現在の活動を表す新しい説明文字列。
    - **戻り値**: None
    - **機能**: tkinterウィジェット（通常は`Label`など）のテキストを更新し、ユーザーに最新のスコアと活動状況（例: "GitHub (+10)"）を視覚的に表示します。
- **`start_gui_loop()`** (src/gui.py):
    - **役割**: tkinter GUIのイベントループを開始し、アプリケーションのウィンドウを表示してユーザーからの操作を待ち受けます。
    - **引数**: なし
    - **戻り値**: None
    - **機能**: tkinterの`mainloop()`メソッドを呼び出し、GUIアプリケーションが画面に表示され、ユーザーインタラクション（ウィンドウの移動、閉じるボタンのクリックなど）に応答できるようにします。この関数が呼び出されると、GUIが閉じられるまでプログラムの実行はブロックされます。

## 関数呼び出し階層ツリー
```

---
Generated at: 2025-11-10 07:05:36 JST
